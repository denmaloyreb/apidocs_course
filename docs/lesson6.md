# Урок 6. Написание документации вручную для генерации сайта-справочника

В этом уроке рассмотрен процесс сборки справочника API, если на проекте нет спецификации в формате  OpenAPI.

В таком случае техническому писателю придется:

1.  Добыть информацию (у разработчиков, из кода, при самостоятельном тестировании уже разработанного API и пр.).
2.  Сделать исходник в формате `.md` для сборки справочника.
3.  Немного изменить конфигурацию в [стартерпаке](https://gitlab.com/denmaloyreb/foliant_slate_starterpack), который мы использовали на предыдущих уроках.

Процесс сбора информации рассматривать не будем, т.к. это отдельный вопрос. Разберемся только с пунктами 2 и 3 из списка выше.

## Подготовка исходника для сборки справочника

Бэкенд `Slate` собирает сайт-справочник из Markdown-исходника, который получается из OpenAPI-спецификации в результате ее обработки препроцессором `Swaggerdoc` (с `Widdershins` под капотом). В случае, если OpenAPI-спецификации нет, подготовка этого самого Markdown-исходника ложится на плечи технического писателя.
Я подготовил пример такого исходника с описанием одного метода (ссылка на него) и назвал его [api.md](https://gitlab.com/denmaloyreb/api-docs-foliant-slate-starterpack/-/blob/reference_without_open_api_spec/src/api.md?ref_type=heads&plain=1):

```markdown

    # API для работы с базой данных о технических писателях и их навыками
    
    API позволяет получать:
    
    - список технических писателей,
    - список навыков каждого из них,
    - информацию о конкретном техническом писателе по идентификатору.
    
    Также здесь можно получать информацию о навыках, добавлять новых технических писателей, редактировать сведения об     имеющихся в базе техписах.
    В версии API 1.0.0 реализовано добавление нового навыка, редактирование навыка, удаление навыка.
    
    # techwriters
    
    Методы для работы с техническими писателями
    
    ## GET /techwriters
    
    *Получение списка технических писателей*
    
    Метод возвращает список технических писателей из базы.
    
    > Пример запроса:
    
    ```shell
    curl -X GET /techwriters \
      -H 'Accept: application/json'
    ```
    
    **Параметры запроса**
    
    Параметр    | Тип данных    | Обязательность параметра | Описание                                                 |
    ------------| --------------|------------------------- |----------------------------------------------------------|
    limit|string| integer(int64)|необязательный            |Количество технических писателей в выдаче (для пагинации)|
    
    > Пример успешного ответа (200 OK):
    
    ```json
      {
      "items": [
        {
          "id": 123,
          "firstName": "Вася",
          "secondName": "Пупкин",
          "patronymic": "Иванович",
          "experience": 12,
          "phoneNumber": 71234567890,
          "email": "pupkin@mail.pup",
          "skills": [
            1,
            2,
            3
          ]
        }
      ],
      "limit": 10
    }
    ```
    
    **Метод возвращает:**
    
    |Поле ответа|Тип данных     |Обязательность поля|Описание                                       |
    |-----------|---------------|-------------------|-----------------------------------------------|
    |items      |массив объектов|обязательное       |Идентификатор технического писателя            |
    |firstName  |строка         |обязательное       |Имя технического писателя                      |
    |secondName |строка         |обязательное       |Фамилия технического писателя                  |
    |patronymic |строка         |необязательное     |Отчество технического писателя                 |
    |experience |число          |обязательное       |Опыт работы (в месяцах)                        |
    |phoneNumber|строка(phone)  |необязательное     |Номер телефона для связи                       |
    |email      |строка(email)  |обязательное       |Адрес электронной почты технического писателя  |
    |skills     |массив чисел   |обязательное       |Список навыков (массив идентификаторов навыков)|
    |limit      |число          |обязательное       |Количество технических писателей в выдаче      |
    
    ***Возможные ошибки***
    
    |HTTP-код|Значение   |Описание                               |
    |--------|-----------|---------------------------------------|
    |200     |OK         |ОК                                     |
    |400     |Bad Request|Неверный формат limit                  |
    |404     |Not Found  |В базе не найдено технических писателей|
    

```

## Как описывать методы API вручную

При описании API вручную учитывайте следующие моменты:

- Первый заголовок первого уровня будет заголовком нашего сайта. Каждый последующий заголовок первого уровня будет восприниматься `Slate` как заголовок, обозначающий группу методов API (в нашем случае это `# techwriters`).
- Заголовки второго уровня используются для обозначения конечных точек (методов) API (в примере это `## GET /techwriters`).
- Текст, который следует после `>`, и блоки кода рендерятся в правой части сайта.
- При подготовке исходника можно использовать практически любые возможности `Markdown`, включая таблицы, inline `HTML` и пр.: `Slate` все благополучно переварит и сгенерирует сайт-справочник.

Написанный вами Markdown-исходник разместите в папке `src` стартерпака.

## Изменения в конфигурации стартерпака для сборки сайта из Markdown-исходника

Т.к. сборка сайта будет происходить из уже готового Markdown-источника, нужды в препроцессоре `swaggerdoc` у нас нет. Поэтому его можно отключить (я просто [закомментировал его в foliant.yml](https://gitlab.com/denmaloyreb/api-docs-foliant-slate-starterpack/-/blob/reference_without_open_api_spec/foliant.yml?ref_type=heads#L8) для наглядности). Там же, в блоке `chapters` я [изменил исходник](https://gitlab.com/denmaloyreb/api-docs-foliant-slate-starterpack/-/blob/reference_without_open_api_spec/foliant.yml?ref_type=heads#L3), из которого будет собираться сайт.
В общем, это все, что нужно изменить, чтобы собрать сайт-справочник из Markdown-файла.

Можете подтянуть себе ветку `reference_without_open_api_spec` из репозитория, с которым мы работали на предыдущих уроках (или склонировать репозиторий полностью, если еще не делали этого ранее) и собрать сайт локально, как описано в Уроке 4.

К слову, вы можете комбинировать сборку сайта из OpenAPI-спецификации и Markdown-файла одновременно. Как это сделать, описано в документации [Foliant](https://foliant-docs.github.io/docs/). Если интересно, можете попробовать самостоятельно.
